# TrajectoryRL Validator — unified image
#
# Phase 1 (cold-start): minimal, just bittensor + set_weights loop
# Phase 2 (production): add clawbench, openclaw deps — same image name
#
# Build:
#   docker build -f docker/Dockerfile.validator -t trajectoryrl-validator .

FROM python:3.10-slim

RUN apt-get update && \
    apt-get install -y --no-install-recommends git && \
    apt-get clean && rm -rf /var/lib/apt/lists/*

WORKDIR /app

# Install bittensor (includes all chain interaction deps)
RUN pip install --no-cache-dir bittensor

# Copy validator entry point
COPY neurons/validator.py neurons/

ENV PYTHONDONTWRITEBYTECODE=1
ENV WALLET_NAME=validator
ENV WALLET_HOTKEY=default
ENV NETUID=11
ENV NETWORK=finney
ENV TARGET_UID=74
ENV WEIGHT_INTERVAL=1500

CMD ["python", "-u", "neurons/validator.py"]
